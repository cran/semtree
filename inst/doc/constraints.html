<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andreas M. Brandmaier" />

<meta name="date" content="2023-11-26" />

<title>Constraints in semtree</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Constraints in semtree</h1>
<h4 class="author">Andreas M. Brandmaier</h4>
<h4 class="date">2023-11-26</h4>



<div id="constraints" class="section level1">
<h1>Constraints</h1>
<div id="load-the-package" class="section level2">
<h2>Load the package</h2>
<p><code>semtree</code> allows different constraints on the split
evaluation (<code>global.invariance</code>,
<code>local.invariance</code>, and <code>focus.parameters</code>). These
can be set in the following object and then passed to the
<code>semtree</code> command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(semtree)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>cnst <span class="ot">&lt;-</span> <span class="fu">semtree.constraints</span>(<span class="at">local.invariance=</span><span class="cn">NULL</span>, </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="at">global.invariance=</span><span class="cn">NULL</span>, </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="at">focus.parameters=</span><span class="cn">NULL</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">semtree</span>(model.x, <span class="at">data=</span>df, <span class="at">constraints=</span>cnst)</span></code></pre></div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>To illustrate the invariance constraints, let’s set up a latent
factor model with four indicators and simulate some data with a known
predictor structure. Let’s create a dataset as follows:</p>
<ul>
<li>a latent construct, <code>lat</code>, measured by four
indicators</li>
<li>two predictors <code>p1</code> and <code>p2</code></li>
<li>only one predictor, <code>p1</code>, has an mean effect on the
latent construct</li>
<li>the other predictor, <code>p2</code>, has an effect on only one
indicator (different loadings across groups; DIF)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size =</span> N,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>             <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size =</span> N,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>             <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> p1)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">7</span>, .<span class="dv">9</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>observed <span class="ot">&lt;-</span> lat <span class="sc">%*%</span> <span class="fu">t</span>(loadings) <span class="sc">+</span> <span class="fu">rnorm</span>(N <span class="sc">*</span> <span class="fu">length</span>(loadings), <span class="at">sd =</span> .<span class="dv">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>observed[, <span class="dv">3</span>] <span class="ot">&lt;-</span> observed[, <span class="dv">3</span>] <span class="sc">+</span> p2 <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">*</span> lat</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>cfa.sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(observed, <span class="at">p1 =</span> <span class="fu">factor</span>(p1), <span class="at">p2 =</span> <span class="fu">factor</span>(p2))</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">names</span>(cfa.sim)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p>Here is the OpenMx model specification</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;OpenMx&quot;</span>);</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>manifests<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>latents<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>model.cfa <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;CFA&quot;</span>, <span class="at">type=</span><span class="st">&quot;RAM&quot;</span>, <span class="at">manifestVars =</span> manifests, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                     <span class="at">latentVars =</span> latents,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;F&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>), </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>) , </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>) ),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>), </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>) , </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;const__x2&quot;</span>,<span class="st">&quot;const__x3&quot;</span>,<span class="st">&quot;const__x4&quot;</span>) ),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;const__F&quot;</span>) ),</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x1&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x1&quot;</span>) ),</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x2&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x2&quot;</span>) ),</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x3&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x3&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x3&quot;</span>) ),</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x4&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x4&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x4&quot;</span>) ),</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;F&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">FALSE</span>), </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_F&quot;</span>) ),</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>), <span class="at">free=</span>F, <span class="at">value=</span><span class="dv">0</span>, <span class="at">arrows=</span><span class="dv">1</span>),</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="fu">mxData</span>(cfa.sim, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>);</span></code></pre></div>
</div>
<div id="global-invariance" class="section level2">
<h2>Global Invariance</h2>
<p>Global invariance is a relatively naive way of estimating a tree, in
which a chosen set of parameters is equal across all leafs. This is
achieved by fixing one or more selected parameters to the sample
estimate <em>before</em> the tree is grown. Global invariance assures
that the chosen parameters don’t differ across the possible subgroups.
However, if the parameters do differ, this leads to misspecification and
jeopardizes the interpretation of the resulting tree structure. Using
this approach is usually not recommended because it’s typically not safe
to assume that parameters are identical across a wide range of splits of
the data. There may be cases in which it may make sense to constrain
loading structures or means but it seems particularly dangerous to
constrain variance components with such an approach.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tree.gc <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.cfa, <span class="at">data=</span>cfa.sim, <span class="at">constraints=</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                   <span class="fu">semtree.constraints</span>(<span class="at">global.invariance =</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>)))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1361.93828825101</span>, new current best<span class="sc">!</span> (was <span class="fl">23484.9260692662</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                                                                             </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="sc">&gt;</span> Global Constraints<span class="sc">:</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; F__x1 F__x2 F__x3 F__x4</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; &gt; Freely Estimated Parameters:</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; VAR_x1 VAR_x2 VAR_x3 VAR_x4 const__x2 const__x3 const__x4 const__F</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1361.93828825086</span>, new current best<span class="sc">!</span> (was <span class="fl">1361.93828825102</span>)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>                                                                             </span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">775.597099292936</span>, new current best<span class="sc">!</span> (was <span class="fl">1001.11041233526</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>                                                                             </span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">115.180917946098</span>, new current best<span class="sc">!</span> (was <span class="fl">380.894324541109</span>)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>Fit attempt <span class="dv">1</span>, fit<span class="ot">=</span><span class="fl">115.180917946094</span>, new current best<span class="sc">!</span> (was <span class="fl">115.180917946098</span>)</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>Fit attempt <span class="dv">2</span>, fit<span class="ot">=</span><span class="fl">115.180917946092</span>, new current best<span class="sc">!</span> (was <span class="fl">115.180917946094</span>)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>Beginning fit attempt <span class="dv">3</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>Beginning fit attempt <span class="dv">4</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>Beginning fit attempt <span class="dv">5</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>Beginning fit attempt <span class="dv">6</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>Beginning fit attempt <span class="dv">7</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>Beginning fit attempt <span class="dv">8</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>Beginning fit attempt <span class="dv">9</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>Beginning fit attempt <span class="dv">10</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>                                                     </span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">85.2213174090948</span>, new current best<span class="sc">!</span> (was <span class="fl">394.702774751871</span>)</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>Fit attempt <span class="dv">1</span>, fit<span class="ot">=</span><span class="fl">85.2213174090668</span>, new current best<span class="sc">!</span> (was <span class="fl">85.2213174090948</span>)</span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>Fit attempt <span class="dv">2</span>, fit<span class="ot">=</span><span class="fl">85.2213174090291</span>, new current best<span class="sc">!</span> (was <span class="fl">85.2213174090668</span>)</span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a>                                                                             </span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">130.509747784777</span>, new current best<span class="sc">!</span> (was <span class="fl">360.827875915721</span>)</span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>Beginning fit attempt <span class="dv">3</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>Beginning fit attempt <span class="dv">4</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>Beginning fit attempt <span class="dv">5</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>Beginning fit attempt <span class="dv">6</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>Beginning fit attempt <span class="dv">7</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>Beginning fit attempt <span class="dv">8</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>Beginning fit attempt <span class="dv">9</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>Beginning fit attempt <span class="dv">10</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>                                                     </span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">80.0094620145946</span>, new current best<span class="sc">!</span> (was <span class="fl">93.0424384715732</span>)</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>Fit attempt <span class="dv">1</span>, fit<span class="ot">=</span><span class="fl">80.0094620145842</span>, new current best<span class="sc">!</span> (was <span class="fl">80.0094620145946</span>)</span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>Beginning fit attempt <span class="dv">3</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>Beginning fit attempt <span class="dv">4</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>Beginning fit attempt <span class="dv">5</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a>Beginning fit attempt <span class="dv">6</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>Beginning fit attempt <span class="dv">7</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>Beginning fit attempt <span class="dv">8</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>Beginning fit attempt <span class="dv">9</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>Beginning fit attempt <span class="dv">10</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>                                                     </span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">23.9736801262466</span>, new current best<span class="sc">!</span> (was <span class="fl">37.4673093132444</span>)</span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>Fit attempt <span class="dv">1</span>, fit<span class="ot">=</span><span class="fl">23.9736801262256</span>, new current best<span class="sc">!</span> (was <span class="fl">23.9736801262466</span>)</span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>Fit attempt <span class="dv">2</span>, fit<span class="ot">=</span><span class="fl">23.9736801262243</span>, new current best<span class="sc">!</span> (was <span class="fl">23.9736801262256</span>)</span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>Beginning fit attempt <span class="dv">3</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>Beginning fit attempt <span class="dv">4</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>Beginning fit attempt <span class="dv">5</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>Beginning fit attempt <span class="dv">6</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a>Beginning fit attempt <span class="dv">7</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a>Beginning fit attempt <span class="dv">8</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a>Beginning fit attempt <span class="dv">9</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a>Beginning fit attempt <span class="dv">10</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a>                                                     </span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a>✔ Tree construction finished [took 8s].</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(tree.gc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Even though we retrieve both predictors in the tree, the tree
structure does not represent the data generating model (<code>p2</code>
is found to be conditional only on <code>p1</code>&gt;=.5) and the
misspecification in the loadings leads to bias in the mean
structure.</p>
</div>
<div id="local-invariance" class="section level2">
<h2>Local Invariance</h2>
<p>Local invariance builds a tree under which all parameters across the
leafs of a tree may differ but the chosen parameters may not differ
significantly from each other. If they differed significantly, the
respective split is not considered a valid split and is not chosen.
Local constraints are implemented by means of an additional test of
measurement invariance. For each possible split, we fit an additional
null model, in which the locally invariant parameters are constrained to
be equal across the two resulting daughter nodes of a split. Only if we
reject this null hypothesis, we believe that there is measurement
non-invariance and disregard the split. A typical use-case is to the set
of loadings of a factor model as <code>local.invariance</code> to allow
a tree with weakly measurement-invariant leafs.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>tree.lc <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.cfa, <span class="at">data=</span>cfa.sim, <span class="at">constraints=</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                   <span class="fu">semtree.constraints</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                     <span class="at">local.invariance=</span> <span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>)))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1361.93828825101</span>, new current best<span class="sc">!</span> (was <span class="fl">23484.9260692662</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                                                                             </span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="sc">&gt;</span> No Invariance alpha selected. alpha.invariance set to<span class="sc">:</span><span class="fl">0.05</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1361.93828825086</span>, new current best<span class="sc">!</span> (was <span class="fl">1361.93828825101</span>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                                                                             </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">757.971687050393</span>, new current best<span class="sc">!</span> (was <span class="fl">1001.11041171627</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>                                                                             </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">110.190258965736</span>, new current best<span class="sc">!</span> (was <span class="fl">360.827876534706</span>)</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>Beginning fit attempt <span class="dv">1</span> of at maximum <span class="dv">10</span> extra tries                         </span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>Beginning fit attempt <span class="dv">2</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>Beginning fit attempt <span class="dv">3</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>Beginning fit attempt <span class="dv">4</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>Beginning fit attempt <span class="dv">5</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>Beginning fit attempt <span class="dv">6</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>Beginning fit attempt <span class="dv">7</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>Beginning fit attempt <span class="dv">8</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>Beginning fit attempt <span class="dv">9</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>Beginning fit attempt <span class="dv">10</span> of at maximum <span class="dv">10</span> extra tries</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>                                                     </span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>✔ Tree construction finished [took 6s].</span></code></pre></div>
<p>Now we find <code>p1</code> as the only predictor that yields
subgroups that pass the measurement invariance test. Even though we have
chosen the four factor loadings as <code>local.invariance</code>
constraint, they are allowed to differ numerically but there was no
significant difference between them.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(tree.lc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="focus-parameters" class="section level2">
<h2>Focus Parameters</h2>
<p>First, we create some data. Here, we generate 1,000 bivariate
observations <code>x1</code> and <code>x2</code> gathered in a data
frame called <code>obs</code>. Also, there are two predictors
<code>grp1</code> and <code>grp2</code>. Predictor <code>grp1</code>
predicts a mean difference in <code>x1</code> whereas <code>grp2</code>
predicts differences only in <code>x2</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>grp1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size=</span>N, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>grp2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size=</span>N, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                        <span class="at">nrow=</span><span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.2</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                                <span class="fl">0.2</span>,<span class="dv">1</span>))</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>obs <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(N,<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>                      <span class="at">Sigma=</span>Sigma)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>obs[,<span class="dv">1</span>] <span class="ot">&lt;-</span> obs[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">ifelse</span>(grp1,<span class="dv">3</span>,<span class="dv">0</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>obs[,<span class="dv">2</span>] <span class="ot">&lt;-</span> obs[,<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">ifelse</span>(grp2,<span class="dv">3</span>,<span class="dv">0</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>df.biv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(obs, <span class="at">grp1=</span><span class="fu">factor</span>(grp1), <span class="at">grp2=</span><span class="fu">factor</span>(grp2))</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">names</span>(df.biv)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p>A tree without constraints should recover both parameters (given
large enough sample and effect sizes) because it explores differences in
both means and covariance structure of <code>x1</code> and
<code>x2</code>. Here is an OpenMx model specification for a saturated
bivariate model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>manifests<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>model.biv <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;Bivariate_Model&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="at">type=</span><span class="st">&quot;RAM&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="at">manifestVars =</span> manifests,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="at">latentVars =</span> <span class="fu">c</span>(),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x1&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>), </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,.<span class="dv">2</span>) , </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x1&quot;</span>,<span class="st">&quot;COV_x1_x2&quot;</span>) ),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x2&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x2&quot;</span>) ),</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>), <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;mu1&quot;</span>,<span class="st">&quot;mu2&quot;</span>),</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>       <span class="at">free=</span><span class="cn">TRUE</span>, <span class="at">value=</span><span class="dv">0</span>, <span class="at">arrows=</span><span class="dv">1</span>),</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">mxData</span>(df.biv, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>);</span></code></pre></div>
<p>Let’s run this model in OpenMx:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(model.biv)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Running Bivariate_Model with 5 parameters</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; Summary of Bivariate_Model </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; free parameters:</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;        name matrix row col  Estimate  Std.Error A</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; 1    VAR_x1      S  x1  x1 4.0283800 0.18015521  </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 2 COV_x1_x2      S  x1  x2 0.3039196 0.11444978  </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; 3    VAR_x2      S  x2  x2 3.2282345 0.14437113  </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; 4       mu1      M   1  x1 1.4187341 0.06346967  </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; 5       mu2      M   1  x2 1.4628999 0.05681795  </span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; Model Statistics: </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;        Model:              5                   1995              8233.926</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt;    Saturated:              5                   1995                    NA</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; Independence:              4                   1996                    NA</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; Number of observations/statistics: 1000/2000</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; Information Criteria: </span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt;       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; AIC:       4243.926               8243.926                 8243.986</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; BIC:      -5547.046               8268.465                 8252.584</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; CFI: NA </span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; TLI: 1   (also known as NNFI) </span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; RMSEA:  0  [95% CI (NA, NA)]</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): NA</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; timestamp: 2023-11-26 14:27:44 </span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; Wall clock time: 0.04078794 secs </span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt; optimizer:  SLSQP </span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt; OpenMx version number: 2.21.1 </span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt; Need help?  See help(mxSummary)</span></span></code></pre></div>
<p>Now, we grow a tree without constraints:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>tree.biv <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, <span class="at">data=</span>df.biv)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585158</span>, new current best<span class="sc">!</span> (was <span class="fl">14528.4141425595</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                                                                             </span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585143</span>, new current best<span class="sc">!</span> (was <span class="fl">8233.92582585158</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>                                                                             </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3454.12434636158</span>, new current best<span class="sc">!</span> (was <span class="fl">4066.88531949563</span>)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>                                                                             </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1555.54412300078</span>, new current best<span class="sc">!</span> (was <span class="fl">1720.05414322814</span>)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>                                                                             </span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1569.26472590267</span>, new current best<span class="sc">!</span> (was <span class="fl">1734.07020313343</span>)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>                                                                             </span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3566.5692080098</span>, new current best<span class="sc">!</span> (was <span class="fl">4167.0405063558</span>)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>                                                                           </span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1593.91684303245</span>, new current best<span class="sc">!</span> (was <span class="fl">1780.60715330577</span>)</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>                                                                             </span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">1576.27862642528</span>, new current best<span class="sc">!</span> (was <span class="fl">1785.96205470403</span>)</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>                                                                             </span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>✔ Tree construction finished [took 4s].</span></code></pre></div>
<p>As expected, we obtain a tree structure that has both <code>p1</code>
and <code>p2</code> (here we use the viridis colors to give each leaf
node a different frame color, which we’ll use later again):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># default white color for all nodes</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>, semtree<span class="sc">:::</span><span class="fu">getNumNodes</span>(tree.biv))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>cols[<span class="fu">as.numeric</span>(<span class="fu">row.names</span>(semtree<span class="sc">:::</span><span class="fu">getTerminalNodes</span>(tree.biv)))] <span class="ot">&lt;-</span> viridis<span class="sc">:::</span><span class="fu">viridis_pal</span>()(<span class="dv">4</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">plot</span>(tree.biv, <span class="at">border.col=</span>cols)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABEVBMVEUAAAAAADoAOjoxaI41t3k6Ojo6OmY6OpA6Zjo6ZmY6ZpA6ZrY6kNtEAVRmOgBmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkGZmkJBmkLZmkNtmtpBmtrZmtttmtv+QOjqQOmaQOpCQZjqQZmaQZpCQkGaQkJCQkLaQkNuQtmaQtpCQtraQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2Zma2ZpC2Zra2kDq2kGa2kJC2kLa2tpC2tra2ttu2tv+225C227a229u22/+2/7a2/9u2///bkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb///95yX/tmb/tpD/trb/25D/27b/29v//7b//9v////za3TnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM/ElEQVR4nO2dC2PTOBaFs8NrYXZgFro0LZRdCEmXJtvQMsTTskOzzYOEplPPhLSx/v8PWUm247evZVuSXe4ZN3VMju71N2l0I9tyg6BS1dCdQNWFgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgABVDFCDSncOQVUqHRtOtRBVKZlGZKUCqmQulUxKvxoxa/pVoVxoKpbprlVGFcqlQaxXfWetOqpQLjSVJQJKEQKC1EBA6cJuHlIj8KsaqlQy/KtYtb5pVAxQBYWAACEgQAgIkHpAc/N66PxuOwtdJ1/aHdPevOqwDSu6ma5Zl8T6tOzSGrI9XCjPlegA9LG57M/a3VnH/HW9by/EMOmyHNqbF+t99rjqEbY2Wr5tvtlud6ddk25RL/WAjFmrf3F6RuZXHeuUL58YoMG//0H4ZtMy+Fvqa5fQNeOqs96ffz49o7AoSfXSAMg84l8o5ub0Xc9eyODgjL6DnM3HB0P6aJz05m8OhhTRYIfiIvT5+vt4B4nJ/ryy9W2kIYGqA9IudYAaYRUyK/tGohBQkcgxL0ZAwIu/M0ALXiVazjNaHrqbbsw4c/wmGdIMyCKWZRGTHG3/zLoo1mcxIJOXhIy3H7DVLzsJad5KQNft7nV7uHk+fvR47/39x4+e9Mn674zGeG/MnpAJ/Tk6/CdjttoAmpuf1sbQ71eVtrpI0/N9wzzdPD/qj/eO+kf9P/+2fsKrRAqI/pcA6NtJf/C8uWqaSjNXC+jXVY9WxJvn4/uPKaD3D5/03//lPqPhBzS59yN7mQdo1aTl9H/9flVp64nEADVfs7dKP/Ja9hnkaPMZZE2DhfTtA4SFopzw1c9Qd/QapKg5eB1y1Bu7FklqDV2PLHVGrkmaGgPXJU99cWuTqLaw9clUV9QapaopaJ1y1ROzVslqCVmvbHVErFm6GgLWLV/18WqXsPJw9ctYdbQapqw4WB1zVhurlkkrDVXPrFVGqmnaCgPVNW91cWqbuLIw9c1cVZQap64oSJ1zVxOj1skrCVHv7FVEqHn6CgLUPX/cAb3NKwght/lb0BHX/CNUfhiZjd+KL5T1LlIUhJLX9C0ZGK311wAV4WQ1fGsO8NX5i7aSkHKavUUnqtR4KEtNWBmN3qoTLstvU98MSVKucCm7RZ6iFkaSZsqVdbhKXzdf6QNwjZg1RZIVGgFlbrek1haa5qtloS8lhC67tcHZh1H57WYKvTysAyBitZKmSpCrBpk8b7pJlNpuua1ZrZGEdjOFtq8mrzqgo4db2t5BLzoSQmMdlLXdctvTN9xR8UqaaJyvVk5kbd+86yIEBAgBAUJAgPICcqes/WZed8xle+ibr3bVZvPVsilr6ZqEyWqd0HbQuNDX7RFLrJzQeQE5U9aufxkZv/WmXdM3X+1i1VusO531PqFrEiardULTBmcdMxy6S+MaF5eEJlZO6LyA7ClrPxtzCqi7sCf0deer/dq1DHP2/CWhaxImq3Vmy2VB52Yk9Oz5i9bv+xZLrJTQuQHZU9be0DxOumzaLG++Wvrs+GA4O+nN2yc9CZPVOqFZUD4nbjA0jTt915svaGKlhJb9Ia1xstpyQmMvBggBAUJAgBAQoBIB3fAh4cT5amVKYujigNz5aq8f77GnifPVSpCK0EUBefPV3nzkWSbOV1u61IQuCsibr5aM3Szj56stXWpCF34HbearjckyMF9t6VITujCgzPPVli41obGbB1QaoLiGNF6KIHW/ymtH48UscnestGY0Xg4lec/KakY6IdmRy2kmuRV9gKTvWkmNSCYkPbT8RqQSkh+5jEaANiQSUhC5hDagJvQBUrF3ZbQgjZCK0EpakERISeTCLWRpQA6gTK0q2b/ifimE1IRW5JdASFHkgv7Mdn2nxqnaw4JujecOqtrFgmaNZ+cq28di5lIJqYtcxCzoLZGQwsgFvKJWfYBU7mURq75xYi2Acjj1DfIp3c0CRn0jNGr3M7fxOwKU06dvgKYuO6rv27XSPdXTbWqJjICKuH4SVMB8R1DB0HfFFDT/IaacgMI7nEE+S3iHYfkYRfYYlM8B7XFUqY5EQMJ0AjZhPH6XKJ2AS5SO40q0JQHKyccx5uPj+PLxcXz5+KQYpQDKy4cb8/LRCMiiy2JzSZrlnXrMz0WmD2y59BnviJg3j8R23s1ituLMzPmHgJku3tacgI5H6w75uEOmZwt7Tg5ivdqcFMgnMqEPbw+N2eGlz3knq3l61jYnO4Mzw83TA5Rq5qvTQ9v8wb2S5+5mN2Hz5NAwztpX3tacgJa9ZW+9b4wmByds5pDJux3CLsy6OD1lcflEJtabp8+a7sQiAUAZzF92Vgf7hjl199EDlG5mq8tnTWp2Z1MJAALN1utnTXaG57IoIKtjmON79/amowm7JG39rxFv8+O9+0NiT2Ritc5bbAcnfc95J6uZkPEPTx9ctFtRQKlmvkr/nZqvNl4fINBs8Zyno8KAyHiHtmW1jJH1hiYy+Nz0QT96uHUypA+DZmvgTCwSAASbJy9a5np/srt5+/k+g9LMdHVGzVvU7M6mEgCUwcxybpnFAfm0WGS6dvin2F4so/lObC+W0Xw3djczmpV18wmAMioeUEbFA8ooBAQoB6CbTya5Pg1ccLUpGxahesYyncLCBSRi9tUzNiDByO6qDUgwspu2OKDly0Vr9nLxYcSLCjuQWzb4io8JrUbYP9iFhekAEjHbxdCUmzkgwchkskODmw4gwcg0Z4Ot5gDEQtKfVY8VFcQrJvgKKz7sqsIuYpaHTmHhABIy82LINnNAYpH7q4MOC+4AEoxMlyU3iwM6HpGb9oj8uceKCuIVE2yFFzF2VeECcgoLB5CQmRdDJjdzQGKR//Pk6f0tvsoBiUVmOW/zVXFAq62TJv2hVcaYX1O0KSboiq/4WO42Z0P6D05h4QASMTvFEDdzQIKRCTU3W+6fmGDkAVu2cv2JBbQpJuCqItqLCZijvZiAOdqLCZixmweEgACVNx4UX0sEnMnjQb5XWqFChCt1PChqthaX1mYkKgxILO3SxoPCtcTgzHhLN012fM7E8SCf2RmVaQ/Ykmk8KMZ8ddGiS/TLKpz29LD99swwvbTLGw8K1RLswWp9Pdj3OZPHgzyzM2JBO9nJX5/FfJvPZB5N+t44S/p4UChtWvzQ3795aZc2HhSuJa7brfPW/548fRAd7kg1+wA9ihswy2Q+79DXbXJOGw8Kp00fPrdf/+ClXdp4UKSW2OWb1jHvoFQzH5WhLdDFrmJCgDKZaVTf5Ftp40HREmhrsNv0uXE8CBB284BKARR/xCfqjAdk+V+a4E8CFIrM+vaoORlQXOKXwZcUAmSRG/4rcsQn1MO7ziCgqNvpaiesq930vlxhQAmRrYuWceiMU3iKAora3cC+41S2igA6Ovj5ZMcw7an4fAdtIj286wwAinP7K4TAPoYAJUWmfTvtp5deecAVARRjdwO/fR70FgJ0fN666rhxfAdtIj18LKCo2zr6se3ked4KvIHCgJIi076dVwjTgDsCKMa++T/jq5/KATTZ3TLDB23CPbzrjAIKup2udrkb6LqZ4gDFRKYhWT/9Yiv9TyzG7gaeeMepbGEvBggBAUJAgMoAFDNiYEUroQRAKUdcfEoAlM2cCCg+8aCKjQfxasI3YsCP0bDhhlf9aagYiY4HJZkH0TIoOh4UNrt1TJw5AijZfvUq2IcVArSpJnzDDewYDessl/1wMRI6gSrFvB0tg0KAYsxuNx1nDgNKsY+WJQJyq4kr33AD2cQxQsVICFCKeTtaBoUAxZh9gCLm0BlmafbyAdFq4rVXs0xetE5YNcEO94SKkdBJnCnm+DLITyjG7NYxMebIOYopdlIYEJ4G7CjtRHLxOL4TycXNvhPJxc2eJw+hPCeSE/ErEQJIRa9ECJyaL3ghQvBiBMELEYCLEUq/4P+2CQEBQkCAEBAgIUDOXXXYbXu+mat2+OuMiLmT1+zczCefmd3155uYWQiQc1cddiuYX0YLwfvlBM2C95LxzPYtfXKajYtLGlzILATIuauOZVwZ8xH52hWKFDBbhtg+bsymfUufnJFbv3dY5iISA2TfVef4YMjv6SP2DgqY6WNOs31Ln5zm6bvejUxA36MQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBATo/xfLwMYU/uKRAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Let us visualize what this tree is doing. Here is the empirical joint
distribution of both <code>x1</code> and <code>x2</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.biv, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2))<span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>()<span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And here is the partition of the observed two-dimensional space
implied by the leafs of the tree (compare the density colors to the
colors of the leaf nodes in the earlier dendrogram):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df.biv.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df.biv, </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="at">leaf=</span><span class="fu">factor</span>(<span class="fu">getLeafs</span>(<span class="at">tree=</span>tree.biv, <span class="at">data =</span> df.biv)))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.biv.pred, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2))<span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="fu">aes</span>(<span class="at">colour=</span>leaf))<span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>What if we were interested only in splits with respect to one of the
two dimensions? In this case, we can set a <code>focus.parameter</code>.
Focus parameters change the split evaluation such that only splits are
evaluated that maximize the misfit between a model in which all
parameters are free and a model in which all parameters are free but the
parameters given in <code>focus.parameter</code>.</p>
<p>Let us first set <code>mu1</code> as focus parameter:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>tree.biv2 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;mu1&quot;</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585158</span>, new current best<span class="sc">!</span> (was <span class="fl">14528.4141425595</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                                                                             </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585143</span>, new current best<span class="sc">!</span> (was <span class="fl">8233.92582585158</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>                                                                             </span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3740.92185296731</span>, new current best<span class="sc">!</span> (was <span class="fl">4086.36288876948</span>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>                                                                             </span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3795.16307144921</span>, new current best<span class="sc">!</span> (was <span class="fl">4147.56293708195</span>)</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>                                                                             </span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>✔ Tree construction finished [took 3s].</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(tree.biv2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As expected, the resulting tree structure only has <code>grp1</code>
as predictor because <code>grp1</code> predicts differences in
<code>mu1</code>. Predictor <code>grp2</code> did not come up anymore.
Now, if we set <code>mu2</code>, we should see the exact opposite
picture:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>tree.biv3 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;mu2&quot;</span>))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585158</span>, new current best<span class="sc">!</span> (was <span class="fl">14528.4141425595</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                                                                             </span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585143</span>, new current best<span class="sc">!</span> (was <span class="fl">8233.92582585158</span>)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>                                                                             </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3454.12434636158</span>, new current best<span class="sc">!</span> (was <span class="fl">4066.88531949563</span>)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>                                                                             </span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">3566.5692080098</span>, new current best<span class="sc">!</span> (was <span class="fl">4167.0405063558</span>)</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>                                                                           </span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>✔ Tree construction finished [took 3s].</span></code></pre></div>
<p>And, indeed, we see only <code>grp2</code> as predictor whereas
<code>grp1</code> was not selected this time.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(tree.biv3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, we set the <code>focus.parameter</code> to one of the
variance parameters. None of the predictors predicts differences in the
variance, so we expect an empty tree (only the root node; no predictors
selected):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>tree.biv4 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;VAR_x2&quot;</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; &gt; Model was not run. Estimating parameters now.</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585158</span>, new current best<span class="sc">!</span> (was <span class="fl">14528.4141425595</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>                                                                             </span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>Beginning initial fit attempt</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>Fit attempt <span class="dv">0</span>, fit<span class="ot">=</span><span class="fl">8233.92582585143</span>, new current best<span class="sc">!</span> (was <span class="fl">8233.92582585158</span>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>                                                                             </span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>✔ Tree construction finished [took 1s].</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="fu">plot</span>(tree.biv4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
