<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andreas M. Brandmaier" />

<meta name="date" content="2022-05-13" />

<title>Constraints in semtree</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Constraints in semtree</h1>
<h4 class="author">Andreas M. Brandmaier</h4>
<h4 class="date">2022-05-13</h4>



<div id="constraints" class="section level1">
<h1>Constraints</h1>
<div id="load-the-package" class="section level2">
<h2>Load the package</h2>
<p><code>semtree</code> allows different constraints on the split evaluation (<code>global.invariance</code>, <code>local.invariance</code>, and <code>focus.parameters</code>). These can be set in the following object and then passed to the <code>semtree</code> command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semtree)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cnst <span class="ot">&lt;-</span> <span class="fu">semtree.constraints</span>(<span class="at">local.invariance=</span><span class="cn">NULL</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">global.invariance=</span><span class="cn">NULL</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">focus.parameters=</span><span class="cn">NULL</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">semtree</span>(model.x, <span class="at">data=</span>df, <span class="at">constraints=</span>cnst)</span></code></pre></div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>To illustrate the invariance constraints, let’s set up a latent factor model with four indicators and simulate some data with a known predictor structure. Let’s create a dataset as follows:</p>
<ul>
<li>a latent construct, <code>lat</code>, measured by four indicators</li>
<li>two predictors <code>p1</code> and <code>p2</code></li>
<li>only one predictor, <code>p1</code>, has an mean effect on the latent construct</li>
<li>the other predictor, <code>p2</code>, has an effect on only one indicator (different loadings across groups; DIF)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size=</span>N, <span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size=</span>N, <span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="at">mean =</span> <span class="dv">0</span><span class="sc">+</span>p1)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">8</span>,.<span class="dv">7</span>,.<span class="dv">9</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> lat <span class="sc">%*%</span> <span class="fu">t</span>(loadings) <span class="sc">+</span> <span class="fu">rnorm</span>(N<span class="sc">*</span><span class="fu">length</span>(loadings),<span class="at">sd =</span> .<span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>observed[,<span class="dv">3</span>]<span class="ot">&lt;-</span>observed[,<span class="dv">3</span>]<span class="sc">+</span>p2<span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span>lat</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>cfa.sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(observed,p1,p2)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cfa.sim)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p>Here is the OpenMx model specification</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;OpenMx&quot;</span>);</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>manifests<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>latents<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>model.cfa <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;CFA&quot;</span>, <span class="at">type=</span><span class="st">&quot;RAM&quot;</span>, <span class="at">manifestVars =</span> manifests, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">latentVars =</span> latents,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;F&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>), </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>) , </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>) ),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>,<span class="st">&quot;x3&quot;</span>,<span class="st">&quot;x4&quot;</span>), </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>) , </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;const__x2&quot;</span>,<span class="st">&quot;const__x3&quot;</span>,<span class="st">&quot;const__x4&quot;</span>) ),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">1</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;const__F&quot;</span>) ),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x1&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x1&quot;</span>) ),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x2&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x2&quot;</span>) ),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x3&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x3&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x3&quot;</span>) ),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x4&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x4&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x4&quot;</span>) ),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;F&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">FALSE</span>), </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_F&quot;</span>) ),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>), <span class="at">free=</span>F, <span class="at">value=</span><span class="dv">0</span>, <span class="at">arrows=</span><span class="dv">1</span>),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mxData</span>(cfa.sim, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
</div>
<div id="global-invariance" class="section level2">
<h2>Global Invariance</h2>
<p>Global invariance is a relatively naive way of estimating a tree, in which a chosen set of parameters is equal across all leafs. This is achieved by fixing one or more selected parameters to the sample estimate <em>before</em> the tree is grown. Global invariance assures that the chosen parameters don’t differ across the possible subgroups. However, if the parameters do differ, this leads to misspecification and jeopardizes the interpretation of the resulting tree structure. Using this approach is usually not recommended because it’s typically not safe to assume that parameters are identical across a wide range of splits of the data. There may be cases in which it may make sense to constrain loading structures or means but it seems particularly dangerous to constrain variance components with such an approach.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tree.gc <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.cfa, <span class="at">data=</span>cfa.sim, <span class="at">constraints=</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">semtree.constraints</span>(<span class="at">global.invariance =</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>)))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable p1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable p2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; Global Constraints:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F__x1 F__x2 F__x3 F__x4</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; Freely Estimated Parameters:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; VAR_x1 VAR_x2 VAR_x3 VAR_x4 const__x2 const__x3 const__x4 const__F</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 3s].</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.gc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Even though we retrieve both predictors in the tree, the tree structure does not represent the data generating model (<code>p2</code> is found to be conditional only on <code>p1</code>&gt;=.5) and the misspecification in the loadings leads to bias in the mean structure.</p>
</div>
<div id="local-invariance" class="section level2">
<h2>Local Invariance</h2>
<p>Local invariance builds a tree under which all parameters across the leafs of a tree may differ but the chosen parameters may not differ significantly from each other. If they differed significantly, the respective split is not considered a valid split and is not chosen. Local constraints are implemented by means of an additional test of measurement invariance. For each possible split, we fit an additional null model, in which the locally invariant parameters are constrained to be equal across the two resulting daugther nodes of a split. Only if we reject this null hypothesis, we believe that there is measurement non-invariance and disregard the split. A typical use-case is to the set of loadings of a factor model as <code>local.invariance</code> to allow a tree with weakly measurement-invariant leafs.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tree.lc <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.cfa, <span class="at">data=</span>cfa.sim, <span class="at">constraints=</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">semtree.constraints</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">local.invariance=</span> <span class="fu">c</span>(<span class="st">&quot;F__x1&quot;</span>,<span class="st">&quot;F__x2&quot;</span>,<span class="st">&quot;F__x3&quot;</span>,<span class="st">&quot;F__x4&quot;</span>)))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &gt; No Invariance alpha selected. alpha.invariance set to:0.05</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable p1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable p2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 5s].</span></span></code></pre></div>
<p>Now we find <code>p1</code> as the only predictor that yields subgroups that pass the measurement invariance test. Even though we have chosen the four factor loadings as <code>local.invariance</code> constraint, they are allowed to differ numerically but there was no significant difference between them.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.lc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="focus-parameters" class="section level2">
<h2>Focus Parameters</h2>
<p>First, we create some data. Here, we generate 1,000 bivariate observations <code>x1</code> and <code>x2</code> gathered in a data frame called <code>obs</code>. Also, there are two predictors <code>grp1</code> and <code>grp2</code>. Predictor <code>grp1</code> predicts a mean difference in <code>x1</code> whereas <code>grp2</code> predicts differences only in <code>x2</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>grp1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size=</span>N, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>grp2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size=</span>N, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrow=</span><span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.2</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.2</span>,<span class="dv">1</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(N,<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Sigma=</span>Sigma)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>obs[,<span class="dv">1</span>] <span class="ot">&lt;-</span> obs[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">ifelse</span>(grp1,<span class="dv">3</span>,<span class="dv">0</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>obs[,<span class="dv">2</span>] <span class="ot">&lt;-</span> obs[,<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">ifelse</span>(grp2,<span class="dv">3</span>,<span class="dv">0</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>df.biv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(obs, grp1, grp2)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df.biv)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p>A tree without constraints should recover both parameters (given large enough sample and effect sizes) because it explores differences in both means and covariance structure of <code>x1</code> and <code>x2</code>. Here is an OpenMx model specification for a saturated bivariate model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>manifests<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model.biv <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;Bivariate_Model&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="at">type=</span><span class="st">&quot;RAM&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="at">manifestVars =</span> manifests,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="at">latentVars =</span> <span class="fu">c</span>(),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x1&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>), </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>), <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>,.<span class="dv">2</span>) , </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x1&quot;</span>,<span class="st">&quot;COV_x1_x2&quot;</span>) ),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;x2&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x2&quot;</span>), <span class="at">free=</span><span class="fu">c</span>(<span class="cn">TRUE</span>), </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">c</span>(<span class="fl">1.0</span>) , <span class="at">arrows=</span><span class="dv">2</span>, <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;VAR_x2&quot;</span>) ),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mxPath</span>(<span class="at">from=</span><span class="st">&quot;one&quot;</span>,<span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>,<span class="st">&quot;x2&quot;</span>), <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;mu1&quot;</span>,<span class="st">&quot;mu2&quot;</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">free=</span><span class="cn">TRUE</span>, <span class="at">value=</span><span class="dv">0</span>, <span class="at">arrows=</span><span class="dv">1</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mxData</span>(df.biv, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<p>Let’s run this model in OpenMx:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(model.biv)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running Bivariate_Model with 5 parameters</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Summary of Bivariate_Model </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; free parameters:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        name matrix row col  Estimate  Std.Error A</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    VAR_x1      S  x1  x1 4.0283800 0.18015521  </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 COV_x1_x2      S  x1  x2 0.3039196 0.11444978  </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    VAR_x2      S  x2  x2 3.2282345 0.14437113  </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       mu1      M   1  x1 1.4187341 0.06346967  </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       mu2      M   1  x2 1.4628999 0.05681795  </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Statistics: </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Model:              5                   1995              8233.926</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Saturated:              5                   1995                    NA</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Independence:              4                   1996                    NA</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations/statistics: 1000/2000</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Information Criteria: </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC:       4243.926               8243.926                 8243.986</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BIC:      -5547.046               8268.465                 8252.584</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CFI: NA </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; TLI: 1   (also known as NNFI) </span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RMSEA:  0  [95% CI (NA, NA)]</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): NA</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; timestamp: 2022-05-13 11:12:58 </span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Wall clock time: 0.04901004 secs </span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimizer:  SLSQP </span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; OpenMx version number: 2.20.3 </span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Need help?  See help(mxSummary)</span></span></code></pre></div>
<p>Now, we grow a tree without constraints:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tree.biv <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, <span class="at">data=</span>df.biv)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 3s].</span></span></code></pre></div>
<p>As expected, we obtain a tree structure that has both <code>p1</code> and <code>p2</code> (here we use the viridis colors to give each leaf node a different frame color, which we’ll use later again):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default white color for all nodes</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>, semtree<span class="sc">:::</span><span class="fu">getNumNodes</span>(tree.biv))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>cols[<span class="fu">as.numeric</span>(<span class="fu">row.names</span>(semtree<span class="sc">:::</span><span class="fu">getTerminalNodes</span>(tree.biv)))] <span class="ot">&lt;-</span> viridis<span class="sc">:::</span><span class="fu">viridis_pal</span>()(<span class="dv">4</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by &#39;ggplot2&#39;:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   method        from</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   print.element sets</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.biv, <span class="at">border.col=</span>cols)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let us visualize what this tree is doing. Here is the empirical joint distribution of both <code>x1</code> and <code>x2</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.biv, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2))<span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>()<span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And here is the partition of the observed two-dimensional space implied by the leafs of the tree (compare the density colors to the colors of the leaf nodes in the earlier dendrogram):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.biv.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df.biv, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">leaf=</span><span class="fu">factor</span>(<span class="fu">getLeafs</span>(<span class="at">tree=</span>tree.biv, <span class="at">data =</span> df.biv)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.biv.pred, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2))<span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="fu">aes</span>(<span class="at">colour=</span>leaf))<span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAADoAAGYAOpAAZrYxaI4zMzM1t3k6AAA6ADo6AGY6OmY6OpA6kNtEAVRNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOpBmZrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQOmaQZgCQtpCQ27aQ29uQ2/+rbk2rbm6rbo6r5OSr5P+2ZgC2Zma2/7a2///Ijk3I///bkDrb2//b///kq27k///95yX/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///9riEsvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAYYklEQVR4nO2dCZvcNnKGx7Zg2hsLStbKpRzrTWJt7k08idcT25ydlTzG//9FIYE6cRDsJsDuXrEei80mQbr5TtVXBYDsvnOHLdrdpT/AtdsBqGIHoIodgCp2AKrYAahipwD6IGEegCp2AKrYAahiB6CKHYAqdgCq2AGoYgegih2AKnYAqlhbQIOw8z/TVVlLQBrKHwmlhoByNG7fpdoBqgJYhWhUtvaTdbQdAa1oETO5AkLNAK1xj5oPpTwu70S7AqogysK4NKFWgNZK8EK7AooLE9obUNmHiiAuS2h3QMWmZQ4XJXQBQHknWqBQir1dCoEOgFZUhWmD6ErVpecpjAv7Glp7QGGtWhVG5bW80EBHIMpRGMu7mlovQCsLZweQpL+MydoCoO6E+gE6IfUPpXgqu8lefLoCYieqqNI40u58XyNTYrvSnsbWFZBSmrJ2j3xYcr0lQntJUI+uxpKv5AY/RnFY0VXiHTvlsN0BgWUHNYaT0lWU6LpZj85qrc8ur0s6k9BqAa4YZPv09HuMBy0DSq4rFWhYiV5Wfcbmtjug3HUOqD9DJEQKzWXGhrqMSZcJDaMcpRZHoAANmoN2nksg2hHQTGRMN+Eq+ok+OAqv/RE1nfbJrNGWqEcxij1hAxVCEaGRl3ptH+sCKOJDfkJiMpXOUX4HMCO95zwGiOh0+xLaARC/my+Nw2wYEAFswl1jks5o4fTaDtYZkFLikKa0CMPIhgyzaZNmmpTNexLqAaigReNAuUocA24E8cXJjI7ikpl16IQPvdV6Aorm6skPdJanlwAKoy4aSrsYoQ5pPnGkQAMuVFU/8gXiC7aNsRBdilA/QPiCQGS6xhQlnWiE+KJ6YNDdMUXoFgFpPjp+HF5yWBUv2M6J+MKXqKkkdMOABrkU0eRjK1wjKRDJM4aRqhnlHpcQ2gtRFdDP//n1qrY5Pn6hFMiJvsTABeGI1SLFmjgNaxBRcm43J6oC+uHVuYAGsZn++qo3po8BdxrjHRpONGbUffKwBujd3//T6YDmxUCL2UBhMMroIOY5yk5XBKhACHd2ZVQB9PNv/zuE2KeTrRi0Zz6OGM0BRlEmshj2v9BvRHjFgJBMFlA44fJ1nG8VQD98tU6DMnyEC8W1Hlc4ntJI3jPKczhFaFwm1A3RMqB3v/pxFaAcH96u+YA/0aHkSGOsX1wvOUWngKIPoWVAP7ya7ata2wIf8CFI6yMsnO5LUB2EmUzNd0h1IkhFQj0QtUjzJT6OelhOXNmYHoV+MihZEi8sQarUTKwDoQaAynwYTwIonhgbyFN0eZASio9Xn6U9oQaVtKoKNaORCkUnwsRlih1yHhFbvFdKUMygcyG0HVAkrTEfbKUVNgLEaWzEDsYoz+5khKU8ehLaDEj0ugZK7uBKo+yrQiXEKoskWIxFcA0YRFE1vTuhrYAy/jPzcYEPt6POKF+hZ0D9Lb+q0xfvgTOUs1g/QhsBRfojAmxwcmgZL2yQgMiPgp9gKnNOhBjsh1MQoR3UGWwboLi04yI6x4c6q5DT8eAwVIYj9hhYnN5cPsAUpesEVOLjlAPxUD0CEqNnUCHCQoQcviR5XrOo3QOy2bYAivQ5SmJy3Ic/PgEauDSUo86U2vCQNM9HZeKYLJvaBkBD5DoRowIguEwujKAlhRWWf6oHK+iEjeJzCN2+KkCijKH8JXupDIh772VAFGfU0lG1RC11HeWcaHu1gERud5qWSPIspYNL5YT4OBlhlPbkxWcJrQf09Pl/JNse7j5KNwo7G1C+ABIr5wGSdSOdhMNKENIJ7FxA71+/WT7mXEBVPnlAsBhGkfMFH3Xx0SJyIf26LsIygHJOpWwToAyWRUAkPEhGvoj8JARqqBM6DdDz27u7j7+d1j+7u7t7OS9frL7omom2dT4zBtmPgu0ZMkPsQCTrWstFUMqzruczA3p+O/F4+OR7H1oPH3/byYOEQKssJgIv/P1lUiI50SIkok2QZI3OhNsGQI+z90x0/vB9eN8fkIs9SQJyNG8obzILCgSdDilHqvvh1gGKlWrJJhoPd95eOvc4vXzUCVCBjwakP7DQaR82IM3MSSiOrqNLIhTzWQnok+/96vvXU3bv5kFnABLKSj36kXUIAWEwrgU0ngroEaqexxnUY1cPKmR3VwAUXfNA6iP8yVFvw6nGOUAJmTqfINITmQnMDOrps10ADQkgJ/RGmOxUBc8hBcICMkLMgLTUlMNs2TDNz150P7382+s3XQClESazV1gFadYn4CiSAYYSvQ6QSIGn8jnLOgEKNsZP0Y2YoQblP0htzAHKZDDpROsD7Dw7G5AOM94uDT61Grp3DAj9h5WmCCiOsDi5d+PTFxD1KPlee+iFDHyhqaaIU2XyVlGF+lhfQPKTy/nDQV7lGA/DulWAJNEbAVQhxO9FX1U7RAJoGFNIYX0nPt0BJfcZBA6sPKOUXaoQK4CiNHbTgOK/L3HgEoggUFLniiqVnJTPCZdwurVJ80QoiygmNDhK7TrIKKmXALGzcZq/ekC5blhkqQ9x7SM5JYAG1puUzy0AKvbDIss9hxr3yUacJHM5QOMYM9qHz8a+WAooR8haO1pLb8XQT6DE/kPOJVqOEojgtA+frcMdOUIxIo9mnDHhYZywmICZ/MeY6T9xzUNwnawO3QCgUpkYAQpYRlwNpbTqcsx4DImRMQPPzDvtQ1FCc/35bB5ynRdxHa0IQWiN8Ab2jZjJ8OqFVg8TI5oeizPd3g7UBNASIZSeoDs8zzHg0vsPjyyCns+RlvBRAbaTA7UBFKmQWCVpxmF7i29pSXhItQMieKBuR/95DDNm2rbMi9UJBRzWDoMd5RYnh6DHtF6mcddRyrSYXOwB6OkX37qHZBZxO6CFIAM+QZGt2BSiJ+iQ4b79KJ4aH2Yn4gJolD7UT6FnSNoazc3nCdmwgMSF7oR78cYEHG+lSlHcJTTSvjZ8bGJ6fzMPKgCKcn0AFLaN7FCUyqZ/RiQw8Vh9aGGQCUeVoNTegeZpjnhbq9tfci4kHYhdiLbMnmPE4JmvFJ2Qn+m9y/HpmOLf/3lMqALo3d+8KjySWXOhKafb8ML+IjUpSLThAAsJzIRj6Ma7EfUnLQ67pPj7+HahZUA//cM37t3ffpNrGwNKCdlhkP0OBkTtJxyQyOxUPocuiTF0ipmO2c9/5snWUz3o919Oi9+hC5VuwSsQ8mIjRBAIgWf5NBWK5UkpvfsEQtFzPGPMp58DPdxlbsera9DsRblnVkuA6NU651SSGFGgIZEFAZoqJGOCG+Hhvo72R8x4wt4ETP8i2tuK58XwgcPkNmBeZgkxIMymI8qPtVjnzN5j8O6gEccChFY7H3YGKV0doJ9+TXyqgJgQdSpQlsE5+PGfwVpjg+7wWLTNPiYH/mOCX+3Mp57FvuY3ZUC5MkgDkl9GAQ3QcQypjGVNhyjTUmQMc7kOQIrPCkDylQGJ+XkLF+b5BEAGE70xA4mP8/tTHObKAIWnnvNZrOJCAwEaoH/hwoYR2mGKNyBABrGBqUBLuOzFp8XDLGLpROGT/9EjG4rm4EDeb8Jydg3PFJQmpC/KZo5WTLSlt7UGFI90JCexQZQN9OjNgFc9YtE0jydiay3MweOc2tTbtgNCQrqfWgQ0hdvoU5gd5skOEwpqJyptX02TiQRPQ2nuFgFlhzpygOZne01woHkuYwYWtmNvlt3EwXud4ZV6d7d2gFQ/NQEkv+AWeqQOSiAzBik34ikx1h9+z3G33/dPqYu+hyHZx3RgNmnrLTsGBKs0tOHSL7OfAc0BZsOgopldx2d4C735YL58FomMA8/sx0dc9P18f+zdmxMALRCyAMVmvujf+HlW70A2yPX06i+esxiYgCIDb0c+fNHhwan3r19sAOREQeh0gUhmjIVE7yNs2hCkiI4yAkrI9cYpfcYY3cciQO757YsNgECfZV0oXxyloFmbw3C98StasUyUyll/DCj0foR0iLkZVGZyKG6LliGkx8HFQL03f4FTnp80yvhQMy5MNoueW2hnRhlftA4C3QnQ89vk+UMp0mG06PntyYCiYUS2ONd7PHaAS5zz/ew/dsAhDSFAIaREfg+7jMj17e3hbglQ1YpfTaEHyQSi4BeUysRX5UxkLPTFjHcn7xjW6eTuZH4PUsSu1N6e/uQvFwE9/9/y8QuAVPmMiCxOa0BGm8rnsH20YerdjKHPOl+thVLa3/+i0hTlfqOi6yxCJjGx8/k3/74YYpP8vPTt/nl1iKnuu5M3SdE7yGRemkIutyF7T3x84TPpkZnJWB6Olh8bB4IY1CZCS/bwclmD5tl7Xwut1yCV4lW3wmI8cZTNlxQkfAyFooHZZe8/Tsk0/n3Jlwznrl6Anr74vgZoTmELTwFn9YonMYT0RHmeLhtWDFSIlu7hmFeNbBps5CBgoeaCuvRBz7MHfFhTWXTRT58lLYptg4lZHiU9YhWXFkIszGb4BD852lw4+gFnG2oAPnqE8IoLxV6Eaml+3n/3wodZ3vIZbxD6rIXIiiyPEmR97M0y7YGB/vg7yiyWSeFokchooCwC1JxQBZB/0HVanqJBLp/AHOOxsKAkb8JUD/nPjMUGjQ6ILHfqg7FQ93ah1BSgvw6v/3MaIJoLdHzrhtV4PBgLV+e7pGE02uuzsSjSNjfro92nqwrlbGOhGGwYZM2sJjEcFNczMUNCNEGZE3zQaRvw0DxjXKaMkL8ygHYg1AQQzsGz1wwDzmXwmo+tkOvnCzOhrjGIR+Y70Tlhdb5lQCA9KDd+nec0MNw4xIznZkZRGhpjLJMhocai0Yh/uxJqBMjiVCHiERkMkzwU0r6X4dXHQGIzoYiOAJEUkdPcMKAwqCzuVhDb2a3mzB4cy/hpDRPiC4PMA2HX4bMjoVyMdSfUDpCYzCA34n8Ucy4UQM7T4SRmqRwaoSZiS13o1gBRrz3Wahlig7rQgEj4j38x6RCSu3CMtQDE1yTue0FU0wrUQSHNK0DOF9LWCkIZQApODKg3oQaAlBxLJ7JQ/kGKMzTkAXTCwln3xw0oylf65imLdRAmsRiQhY48MjJ0rBzPSgjdECBZ2lmR7wOfqV9qeTQIlxEg45UahRqraScOwhx244AwykLPC16oRcQHEYFOG4gx8BxRSssknwPUmdBWQJED4T8L0/MoQ9YXPhBny4BkoeDNyGN6Anp+e9ZtwIttS3wcvQIiuAwbA4LeGQRZFpDbC9D9m/DNXcq2AVJ8BBzhO1RGh6ZFQFgQZQBpQkkaa0Xo/V/khnk2AYr9R/KhFy1BSaKH3C6DLOZTA3QCoSEx3vf0xb+0DjEbLTUV6T/kQBqQFYCsMQqQnLcKh5RirJEPPX32Zp7ZiLZuAVRwIOKD8hMUem4AmoyALHiQhWqR+vOWZ/REFusN6IvTH2ZZbiscyCoHstB9YL8ykMGRD3bnHQ6fQZmYme/ELKZjLELSgtD7v+oJCBb4n1YiAkQOZOlqQ6XouLfBZ0ZbAagJofsuIRYrkFWgnARElESyDyMegk5BpPcAlL3zpxsgke2dBGSkTkN4rQIkGfUBlLUNgLIRlokxB9kcIsxickdHUhMbwulUX/VaAf3061e//LHQtgxIpfrZUkBhYkOWiiHTR/elcJo3y4C6EVoGNP/62g9fFtoWAGX4cD0IPHhgSFZCMKuqIuzKAf30j9+5d3/3Xb5tpkyMANGFxoBwG4654qhHRoJkGbQEqBehyvNiv/qx+MxqA0BShCDH3Rig3/8SAWXaWvEiMpioZyQglCDHYWPRi6QOOc2HEp5E5K4GEHtQpi0CilL8IiB2IO6WLTsQATLXCGiFBmVSWAmQ5cLZsS9RweiPMMZIQKxWMtG7DI5LZbGvallMAiI8ZUAOAFE1bSWg4C/iWouAdiuENtRBsQitBMRdDiJjRAvyMDjOxUXiVXnQcttcjBWzWAGQdSkgulgZix84IEspTvIRAaaT/H4R1mTIVVdBuRgjQNbUAekpMWMSH+KdbDcISBIqAgqVtAKUxhc5UF9A4T7p074/qNLWihWt0okLQf0TldOQ+Y0okPJ8nB5w7eZAjad9JCBVBiVjg+sAWZpTVZ15pc9ZQKYRoHTEtQ+g1IWg/rG6L4aQ4Nq5vVYhCScbYevxjImp3emX4DUFJEWIVcg3IkDsBcbJq8Z7p0Jr6SaCTCnJtwqwjAP1A6SCzOYBybFpKoJcMlYWMerGJ6NAzQFlCYXhMcudjRgQBx8l+cKdQV0dyN1nHuRpUShmAMVZTKo09CUw4fOAWXTHFL0azel8BarY828yvxTVHlCeEAEiN1LDiSZKevASi1UuwlplsLwEdQWk0phFIUYeVuR5ujnRY9R+FDtRBKgZnoI1BUTiI90HFjnvkXDwUTHhEIlKZx3ohAs4x1oDEv8JkYZg0kNC6EY4Wh/NystcXwbUm8/2iUNaVYDoXV6ltQhRlShOmUTZhfg0BCTQSP2BVrISkm6ECSwCZOSKSVaSZv3sfEA2Xs+Q8f+CI4HjkPbADZ0W5NnAYHR0+8uyA7VLYGVrA2iJDCyAA2AC74F5VhenLzRoFeUztbe3nQ1I8UmDSvqUN+iuY4yJILMZCYJjaJnN8bcGqEAIn5oPtSDnMHpyw5LrZAHp4Nqbz9mAomtRgERgwcKzUE+sWpwdo4H69Oa7a3CgVoCSpOUXhGg2CKegOhRklgMsLJMbYNxF+WwDlKmEiJCIs6DWxmGHHr+jAm99NfIrGiLTUXZLgHzc8A9TWL1w2n+olMZeqeHno1zox18pnxbPi/EL0+AVDrHQAh53CpsMnyG5+5ea5XuptwNICAiT0VIUvh8QHclhfnfQH+O2EaUr4NPumdVIlCD4xDcJGbhPxgROxsHXKhp5Ft/QwD0MfCvDJfoYYL0A+Xecyxy6DsaYuEVBxBlZfkhI7D/hY2+ztk89J+UR1UGcziGFiWuM7glSdqlOPFnL5+ZdAkjGmEFaqDvRt0ZnRTpfQu/IpzsgR4w4kvhJHmqBGxaHzNTWvazdV1NkVFokfBrdcLH8JL/xFT3yE/M54QO3sF6AqKAWaYzLa7x4LKYXTPPZ2X1c0y83UT0NuVN/fxAFHH/3ZNmM4rM/nl6Akq6sJRqU9GX2L5kuEC+ApxUg2dFwQnRjM1KPaZtuIh7GVB2Sy/DpAmhBVugrFeI7Nf2aqKELs9D7W0NA1FeNUplqZqh9VEkXCVzUf3oAEhs1MUvDZLocWgZ02QDrCkgOpwlP4q8jFWRyZTQ1drLx3rYPIG2YwerVzeXqQ7J+gJakWr1k9icj+Bfj0wpQSmiBD85oZC87H2xXC6j8Q7SRJQViGRBL9XoS1wpo4YdoI4u7GMt8ikF2dXxqj2Qu/BCttghQuQ+afJuQslsDNFvxoV5lcmAjGcAQzXQPLL7w6+NTB1T+IVpttWEL34YbZQktl4qXsfJF/+7Vqy8Xf4hW2wpAskkOUKVUvIxVs9jX/Ga5bZVQNG+hXqLVXCl0Ias8Fr70Q7SxVQjFA6vR68WmLSq2fNHLP0Qb2xKhVLcjQnqOo/J/2tFaVdLeKsWPNu06JrfnGqwpoDKhJUDZGfmrsbaACoTydVG9C38N1hhQfuYw3/QKq8KMtQaU8ZZSXf2BAkqAlJU7Xxiu/zy7WAdAGtHS1Gl2POiED7SHdQEkRj0Wq8erGhkrWB9AeGdrpbj+gAG5mvMES3F8QIBW2coBoQvahQGtGhC6qF0a0MVurVtrFwdUvM3jSuzygGhwrNPZN9o1ALpqOwBV7ABUsQNQxQ5AFTsAVewAVLEDUMUOQBU7AFXsJEB5+7Sw/YxWzU51GUAF+7Rdq4anamUHoIodgCr2QQrvKXYAqtgBqGIHoIodgCq2CRA/qDDfq/dn3+Xa8C9zqN/oOP1Ect/CqVrbFkDiQQW6Gz82/oUy/VtlJ59I7ls4VXPbAogfVPj5t98U2vCvA+nfCTr5RHLfwqma21YNCg8qTC4vngqSxr8vpX9p6uQTyX2VUzW1jYDgQYU5PvJ/fP6FMv1bZSefSO5bPlVbOxdQ+qBCXj5WelD9RHLfzXiQvhE/e12rNGjNieS+W9EgvqzZ53/+r9wn5l8o079VdvKJ5L6FUzW3LYDgQYX5bzmt/mne5UPJMrcpFy+rTuRg3/KpmttRSVfsAFSxA1DFDkAVOwBV7ABUsSsAlP3FmKuxKwB0/9EBaMHev747AOXsYcLy/vVL9/ji6fMDUM7uX8z/TXYAytvT5//6i2/DygEoaw/wo68HoILd34Uf7TwA5e3x4/997V3oAJS19xOdx49nEToAZe3+k+/d89s5yA5AN20HoIodgCp2AKrYAahiB6CKHYAqdgCq2AGoYgegiv0/JZomUr34MzQAAAAASUVORK5CYII=" /><!-- --></p>
<p>What if we were interested only in splits with respect to one of the two dimensions? In this case, we can set a <code>focus.parameter</code>. Focus parameters change the split evaluation such that only splits are evaluated that maximize the misfit between a model in which all parameters are free and a model in which all parameters are free but the parameters given in <code>focus.parameter</code>.</p>
<p>Let us first set <code>mu1</code> as focus parameter:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tree.biv2 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;mu1&quot;</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 3s].</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.biv2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As expected, the resulting tree structure only has <code>grp1</code> as predictor because <code>grp1</code> predicts differences in <code>mu1</code>. Predictor <code>grp2</code> did not come up anymore. Now, if we set <code>mu2</code>, we should see the exact opposite picture:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tree.biv3 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;mu2&quot;</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 3s].</span></span></code></pre></div>
<p>And, indeed, we see only <code>grp2</code> as predictor whereas <code>grp1</code> was not selected this time.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.biv3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, we set the <code>focus.parameter</code> to one of the variance parameters. None of the predictors predicts differences in the variance, so we expect an empty tree (only the root node; no predictors selected):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tree.biv4 <span class="ot">&lt;-</span> <span class="fu">semtree</span>(model.biv, df.biv, <span class="at">constraints=</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">semtree.constraints</span>(<span class="at">focus.parameters =</span> <span class="st">&quot;VAR_x2&quot;</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp1 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2716&gt; Variable grp2 is numeric but has only few unique values. Consider recoding as ordered factor.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;U+2714&gt; Tree construction finished [took 1s].</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree.biv4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
